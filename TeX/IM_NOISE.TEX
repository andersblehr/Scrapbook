%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -*- Mode: Latex -*- %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% im_noise.tex --- 
%%% Author          : blehr
%%% Created On      : Thu Mar 11 05:38:23 1993
%%% Last Modified By: blehr
%%% Last Modified On: Mon Mar 22 03:10:36 1993
%%% RCS revision    : $Revision$ $Locker$
%%% Status          : In writing....
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Noise Reduction}
\label{image:noise}

Noise reduction, or {\em smoothing\/}, is the process of reducing or,
if possible, removing unwanted spurious effects (noise) that may be
present in an image.  Noise in a digital image may stem from several
sources, such as a bad transmition channel or a poor sampling system.
In this section, noise reduction techniques both in the spatial and
frequency domains are considered.

Whether noise reduction measures have to be taken in the final
implementation of the complete eye-tracking system is not clear at
present.  By ensuring optimal light conditions and using ``clean''
transmission channels, relatively noiseless images ought to be
obtainable.  This section is meant as an indicator towards some
possible noise reduction schemes if it at a later stage of the project
should turn out that the noise present in the supplied images cannot
be ignored.

\subsection{Averaging}
\label{image:noise:averaging}

{\em Averaging\/} is a general technique with which the value at a
given pixel location in an image is replaced by the average value of a
set of pixels, either from the same image, or from a set of images.

\subsubsection{Neighbourhood Averaging}

In {\em neighbourhood averaging\/}, the value at a given pixel
location is replaced by the average value of the pixel in a defined
neighbourhood of the location.  The spatial mask proposed on
page~\pageref{pg:image:spatial:mask} corresponds to neighbourhood
averaging where the neighbourhood is defined to be the 8-neighbours of
the given location plus the location itself.  The general formulation
of neighbourhood averaging of an $N\times N$ image $f$ is
\begin{equation}
\label{eq:averaging:neighbourhood}
  g(x,y)=\frac{1}{M}\sum_{(n,m)\in S}f(n,m)
\end{equation}
for $x,y=0,1,2,\ldots,N-1$, where $S$ is the set of coordinates
defining the neighbourhood of $(x,y)$, and $M$ is the number of points
in the neighbourhood.

Given that the noise values at each point in the image are independent
samples from a distribution whose mean is 0, it is clear that the
standard deviation of the noise present is reduced by neighbourhood
averaging (for a formal proof of this, see~\cite{digpic}), thus
indicating an improved signal-to-noise (S/N) ratio.

An obvious side-effect of neighbourhood averaging is one of {\em
  blurring\/} the image.  The degree of blurring is proportional to
the size of averaging neighbourhood used.  If the noise is finer
grained than the smallest details of interest in the image, the
blurring can be made negligible by choosing a correspondingly small
averaging neighbourhood.  If this is not the case, or if it for some
reason is desirable to use a larger averaging neighbourhood, the
averaging can be ``switched off'' in regions with large variations in
gray level (lines, edges, etc.) by using the following criterion
instead of Eq.~\ref{eq:averaging:neighbourhood}:
\begin{equation}
  g(x,y)=\left\{
    \begin{array}{ll}
      \frac{1}{M}\sum_{(m,n)\in S}f(m,n) &
        \mbox{if $\left|f(x,y)-\frac{1}{M}\sum_{(m,n)\in
            S}f(m,n)\right|<T$} \\
      f(x,y) & \mbox{otherwise,}
    \end{array}\right.
\end{equation}
where $T$ is a specified nonnegative threshold.

\subsubsection{Averaging of Multiple Images}

When several images $g_{i}$ which have been formed by adding a noise
function $\eta$ to an original image $f$, and the noise $\eta$ at each
location $(x,y)$ is uncorrelated with mean 0, an image $\overline{g}$
with reduced noise level can be computed by assigning to each pixel
the average value of the gray levels of the corresponding pixels in
all the noisy images at hand:
\begin{equation}
  \overline{g}(x,y)=\frac{1}{M}\sum_{i=1}^{M}f_{i}(x,y)\mbox{,}
\end{equation}
where $M$ is the number of noisy images.  Since the mean of the noise
function $\eta(x,y)$ is 0, the expected value of $\overline{g}$ at any
point is given by
\begin{equation}
  E\{\overline{g}(x,y)\}=f(x,y)\mbox{.}
\end{equation}
The standard deviation at any point in the average image is given by
\begin{equation}
  \sigma_{\overline{g}(x,y)}=\frac{1}{\sqrt{M}}\sigma_{\eta(x,y)}\mbox{,}
\end{equation}
thus indicating that as $M$ increases, $\overline{g}$ approaches the
original image $f$.

The obvious drawback of this method is the requirement of having $M$
images of the same scene at hand.  This may be the case with grainy
photographs or ``snowy'' TV-frames, but in the case of noisy images in
a real-time image application, this would hardly be the most
cost-efficient approach.

\subsection{Median Filtering}
\label{image:noise:median}

{\em Median filtering\/} is a technique with which the gray level of
each pixel in an image is replaced by the {\em median\/} of the gray
levels in a neighbourhood of that pixel, instead of by the average, as
was the case in the previous section.  The median of a set of values
is the value that is such that half of the values in the set is
smaller than or equal to it, and the other half is greater than or
equal to it.  For exampel, suppose that a $3\times 3$ neighbourhood at
location $(x,y)$ (Fig.~\ref{fig:neighbour}) has the values
$(51,49,47,53,98,50,51,52,49)$, where $98$ is the value at $(x,y)$.
This value corresponds to a single-pixel spike, and can be assumed to
represent a noise point.  A {\em median filter\/} placed at $(x,y)$
sorts the pixel values in this neighbourhood and assigns to the pixel
at $(x,y)$ the median of this sorted set of values.  In the example,
the values are sorted as $(47,49,49,50,50,51,52,53,98)$.  The median
is seen to be $50$, and thus the pixel corresponding to the spike is
assigned the value 50 by the filter.

The effect of median filtering is one of forcing points with very
distinct gray levels to be more like their neighbours, thus
eliminating intensity spikes like the one in the example above.  The
superiority of median filtering over e.g.\ neighbourhood averaging in
noise removal is clearly demonstrated by the example on p.\ 163
in~\cite{digim}.

\subsection{Frequency Domain Methods}
\label{image:noise:frequency}

By observing that noise in an image mostly is high-frequency in
content, it is obvious that by properly manipulating the Fourier
transform of the image, noise reduction can be achieved.

\subsubsection{Lowpass Filtering}

The most general, and also most obvious, approach to noise reduction
in the frequency domain, is lowpass filtering, as touched upon in
Section~\ref{image:frequency:image}.  Since not only the noise, but
also gray level transitions in the image are high-frequency in
content, lowpass filtering, as was the case also for neighbourhood
averaging, has the side-effect of blurring the image.  By using a
lowpass Butterworth filter (Fig.~\ref{fig:lowpass}(b)) instead of an
ideal lowpass filter (Fig.~\ref{fig:lowpass}(a)), the degree of
blurring is reduced.  This is because the ``tail'' of the Butterworth
filter lets a fairly high amount of high-frequency information
through.  In addition, an ideal lowpass filter tends to introduce what
is commonly referred to as {\em ringing\/} into the processed image,
thus further reducing its quality (for an explanation of ringing, see
for instance~\cite{digim}).

An approach equivalent to lowpass filtering is {\em low frequency
  emphasis\/}, emphasizing low frequencies without filtering out the
high frequency end of the Fourier spectrum completely (compare {\em
  high frequency emphasis\/}, Section~\ref{image:frequency:image}).
This technique also tends to blur the image, but the blurring is not
so predominant as for pure lowpass filtering.

\subsubsection{Selective Filtering}

If the noise consists of a {\em regular pattern\/} which has been
superimposed on the image, this pattern tends to have most or all of
its energy concentrated at small spots in the frequency plane.  Thus,
if the Fourier transform of this superimposed pattern is known, it can
be removed entirely simply by frequency-domain subtraction of its
Fourier transform from the Fourier transform of the noisy image.  The
loss of information in the processed image will be negligible.

If the nature of the superimposed noise is only partly known, but one
is able to locate the spots in the frequency plane where most of the
energy of the noise seems to be concentrated, one can reduce the
amount of noise in the image without serious loss of information by
suppressing these spots.  This is called {\em selective filtering\/}.
